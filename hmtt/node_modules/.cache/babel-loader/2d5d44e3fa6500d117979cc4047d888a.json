{"ast":null,"code":"// Utils\nimport { createNamespace } from '../utils';\nimport { isHidden } from '../utils/dom/style';\nimport { getScroller } from '../utils/dom/scroll'; // Mixins\n\nimport { BindEventMixin } from '../mixins/bind-event'; // Components\n\nimport Loading from '../loading';\n\nvar _createNamespace = createNamespace('list'),\n    createComponent = _createNamespace[0],\n    bem = _createNamespace[1],\n    t = _createNamespace[2];\n\nexport default createComponent({\n  mixins: [BindEventMixin(function (bind) {\n    if (!this.scroller) {\n      this.scroller = getScroller(this.$el);\n    }\n\n    bind(this.scroller, 'scroll', this.check);\n  })],\n  model: {\n    prop: 'loading'\n  },\n  props: {\n    error: Boolean,\n    loading: Boolean,\n    finished: Boolean,\n    errorText: String,\n    loadingText: String,\n    finishedText: String,\n    immediateCheck: {\n      type: Boolean,\n      default: true\n    },\n    offset: {\n      type: [Number, String],\n      default: 300\n    },\n    direction: {\n      type: String,\n      default: 'down'\n    }\n  },\n  data: function data() {\n    return {\n      // use sync innerLoading state to avoid repeated loading in some edge cases\n      innerLoading: this.loading\n    };\n  },\n  updated: function updated() {\n    this.innerLoading = this.loading;\n  },\n  mounted: function mounted() {\n    if (this.immediateCheck) {\n      this.check();\n    }\n  },\n  watch: {\n    loading: 'check',\n    finished: 'check'\n  },\n  methods: {\n    // @exposed-api\n    check: function check() {\n      var _this = this;\n\n      this.$nextTick(function () {\n        if (_this.innerLoading || _this.finished || _this.error) {\n          return;\n        }\n\n        var el = _this.$el,\n            scroller = _this.scroller,\n            offset = _this.offset,\n            direction = _this.direction;\n        var scrollerRect;\n\n        if (scroller.getBoundingClientRect) {\n          scrollerRect = scroller.getBoundingClientRect();\n        } else {\n          scrollerRect = {\n            top: 0,\n            bottom: scroller.innerHeight\n          };\n        }\n\n        var scrollerHeight = scrollerRect.bottom - scrollerRect.top;\n        /* istanbul ignore next */\n\n        if (!scrollerHeight || isHidden(el)) {\n          return false;\n        }\n\n        var isReachEdge = false;\n\n        var placeholderRect = _this.$refs.placeholder.getBoundingClientRect();\n\n        if (direction === 'up') {\n          isReachEdge = scrollerRect.top - placeholderRect.top <= offset;\n        } else {\n          isReachEdge = placeholderRect.bottom - scrollerRect.bottom <= offset;\n        }\n\n        if (isReachEdge) {\n          _this.innerLoading = true;\n\n          _this.$emit('input', true);\n\n          _this.$emit('load');\n        }\n      });\n    },\n    clickErrorText: function clickErrorText() {\n      this.$emit('update:error', false);\n      this.check();\n    },\n    genLoading: function genLoading() {\n      var h = this.$createElement;\n\n      if (this.innerLoading && !this.finished) {\n        return h(\"div\", {\n          \"key\": \"loading\",\n          \"class\": bem('loading')\n        }, [this.slots('loading') || h(Loading, {\n          \"attrs\": {\n            \"size\": \"16\"\n          }\n        }, [this.loadingText || t('loading')])]);\n      }\n    },\n    genFinishedText: function genFinishedText() {\n      var h = this.$createElement;\n\n      if (this.finished) {\n        var text = this.slots('finished') || this.finishedText;\n\n        if (text) {\n          return h(\"div\", {\n            \"class\": bem('finished-text')\n          }, [text]);\n        }\n      }\n    },\n    genErrorText: function genErrorText() {\n      var h = this.$createElement;\n\n      if (this.error) {\n        var text = this.slots('error') || this.errorText;\n\n        if (text) {\n          return h(\"div\", {\n            \"on\": {\n              \"click\": this.clickErrorText\n            },\n            \"class\": bem('error-text')\n          }, [text]);\n        }\n      }\n    }\n  },\n  render: function render() {\n    var h = arguments[0];\n    var Placeholder = h(\"div\", {\n      \"ref\": \"placeholder\",\n      \"key\": \"placeholder\",\n      \"class\": bem('placeholder')\n    });\n    return h(\"div\", {\n      \"class\": bem(),\n      \"attrs\": {\n        \"role\": \"feed\",\n        \"aria-busy\": this.innerLoading\n      }\n    }, [this.direction === 'down' ? this.slots() : Placeholder, this.genLoading(), this.genFinishedText(), this.genErrorText(), this.direction === 'up' ? this.slots() : Placeholder]);\n  }\n});","map":{"version":3,"names":["createNamespace","isHidden","getScroller","BindEventMixin","Loading","_createNamespace","createComponent","bem","t","mixins","bind","scroller","$el","check","model","prop","props","error","Boolean","loading","finished","errorText","String","loadingText","finishedText","immediateCheck","type","default","offset","Number","direction","data","innerLoading","updated","mounted","watch","methods","_this","$nextTick","el","scrollerRect","getBoundingClientRect","top","bottom","innerHeight","scrollerHeight","isReachEdge","placeholderRect","$refs","placeholder","$emit","clickErrorText","genLoading","h","$createElement","slots","genFinishedText","text","genErrorText","render","arguments","Placeholder"],"sources":["C:/Users/小王/node_modules/vant/es/list/index.js"],"sourcesContent":["// Utils\nimport { createNamespace } from '../utils';\nimport { isHidden } from '../utils/dom/style';\nimport { getScroller } from '../utils/dom/scroll'; // Mixins\n\nimport { BindEventMixin } from '../mixins/bind-event'; // Components\n\nimport Loading from '../loading';\n\nvar _createNamespace = createNamespace('list'),\n    createComponent = _createNamespace[0],\n    bem = _createNamespace[1],\n    t = _createNamespace[2];\n\nexport default createComponent({\n  mixins: [BindEventMixin(function (bind) {\n    if (!this.scroller) {\n      this.scroller = getScroller(this.$el);\n    }\n\n    bind(this.scroller, 'scroll', this.check);\n  })],\n  model: {\n    prop: 'loading'\n  },\n  props: {\n    error: Boolean,\n    loading: Boolean,\n    finished: Boolean,\n    errorText: String,\n    loadingText: String,\n    finishedText: String,\n    immediateCheck: {\n      type: Boolean,\n      default: true\n    },\n    offset: {\n      type: [Number, String],\n      default: 300\n    },\n    direction: {\n      type: String,\n      default: 'down'\n    }\n  },\n  data: function data() {\n    return {\n      // use sync innerLoading state to avoid repeated loading in some edge cases\n      innerLoading: this.loading\n    };\n  },\n  updated: function updated() {\n    this.innerLoading = this.loading;\n  },\n  mounted: function mounted() {\n    if (this.immediateCheck) {\n      this.check();\n    }\n  },\n  watch: {\n    loading: 'check',\n    finished: 'check'\n  },\n  methods: {\n    // @exposed-api\n    check: function check() {\n      var _this = this;\n\n      this.$nextTick(function () {\n        if (_this.innerLoading || _this.finished || _this.error) {\n          return;\n        }\n\n        var el = _this.$el,\n            scroller = _this.scroller,\n            offset = _this.offset,\n            direction = _this.direction;\n        var scrollerRect;\n\n        if (scroller.getBoundingClientRect) {\n          scrollerRect = scroller.getBoundingClientRect();\n        } else {\n          scrollerRect = {\n            top: 0,\n            bottom: scroller.innerHeight\n          };\n        }\n\n        var scrollerHeight = scrollerRect.bottom - scrollerRect.top;\n        /* istanbul ignore next */\n\n        if (!scrollerHeight || isHidden(el)) {\n          return false;\n        }\n\n        var isReachEdge = false;\n\n        var placeholderRect = _this.$refs.placeholder.getBoundingClientRect();\n\n        if (direction === 'up') {\n          isReachEdge = scrollerRect.top - placeholderRect.top <= offset;\n        } else {\n          isReachEdge = placeholderRect.bottom - scrollerRect.bottom <= offset;\n        }\n\n        if (isReachEdge) {\n          _this.innerLoading = true;\n\n          _this.$emit('input', true);\n\n          _this.$emit('load');\n        }\n      });\n    },\n    clickErrorText: function clickErrorText() {\n      this.$emit('update:error', false);\n      this.check();\n    },\n    genLoading: function genLoading() {\n      var h = this.$createElement;\n\n      if (this.innerLoading && !this.finished) {\n        return h(\"div\", {\n          \"key\": \"loading\",\n          \"class\": bem('loading')\n        }, [this.slots('loading') || h(Loading, {\n          \"attrs\": {\n            \"size\": \"16\"\n          }\n        }, [this.loadingText || t('loading')])]);\n      }\n    },\n    genFinishedText: function genFinishedText() {\n      var h = this.$createElement;\n\n      if (this.finished) {\n        var text = this.slots('finished') || this.finishedText;\n\n        if (text) {\n          return h(\"div\", {\n            \"class\": bem('finished-text')\n          }, [text]);\n        }\n      }\n    },\n    genErrorText: function genErrorText() {\n      var h = this.$createElement;\n\n      if (this.error) {\n        var text = this.slots('error') || this.errorText;\n\n        if (text) {\n          return h(\"div\", {\n            \"on\": {\n              \"click\": this.clickErrorText\n            },\n            \"class\": bem('error-text')\n          }, [text]);\n        }\n      }\n    }\n  },\n  render: function render() {\n    var h = arguments[0];\n    var Placeholder = h(\"div\", {\n      \"ref\": \"placeholder\",\n      \"key\": \"placeholder\",\n      \"class\": bem('placeholder')\n    });\n    return h(\"div\", {\n      \"class\": bem(),\n      \"attrs\": {\n        \"role\": \"feed\",\n        \"aria-busy\": this.innerLoading\n      }\n    }, [this.direction === 'down' ? this.slots() : Placeholder, this.genLoading(), this.genFinishedText(), this.genErrorText(), this.direction === 'up' ? this.slots() : Placeholder]);\n  }\n});"],"mappings":"AAAA;AACA,SAASA,eAAT,QAAgC,UAAhC;AACA,SAASC,QAAT,QAAyB,oBAAzB;AACA,SAASC,WAAT,QAA4B,qBAA5B,C,CAAmD;;AAEnD,SAASC,cAAT,QAA+B,sBAA/B,C,CAAuD;;AAEvD,OAAOC,OAAP,MAAoB,YAApB;;AAEA,IAAIC,gBAAgB,GAAGL,eAAe,CAAC,MAAD,CAAtC;AAAA,IACIM,eAAe,GAAGD,gBAAgB,CAAC,CAAD,CADtC;AAAA,IAEIE,GAAG,GAAGF,gBAAgB,CAAC,CAAD,CAF1B;AAAA,IAGIG,CAAC,GAAGH,gBAAgB,CAAC,CAAD,CAHxB;;AAKA,eAAeC,eAAe,CAAC;EAC7BG,MAAM,EAAE,CAACN,cAAc,CAAC,UAAUO,IAAV,EAAgB;IACtC,IAAI,CAAC,KAAKC,QAAV,EAAoB;MAClB,KAAKA,QAAL,GAAgBT,WAAW,CAAC,KAAKU,GAAN,CAA3B;IACD;;IAEDF,IAAI,CAAC,KAAKC,QAAN,EAAgB,QAAhB,EAA0B,KAAKE,KAA/B,CAAJ;EACD,CANsB,CAAf,CADqB;EAQ7BC,KAAK,EAAE;IACLC,IAAI,EAAE;EADD,CARsB;EAW7BC,KAAK,EAAE;IACLC,KAAK,EAAEC,OADF;IAELC,OAAO,EAAED,OAFJ;IAGLE,QAAQ,EAAEF,OAHL;IAILG,SAAS,EAAEC,MAJN;IAKLC,WAAW,EAAED,MALR;IAMLE,YAAY,EAAEF,MANT;IAOLG,cAAc,EAAE;MACdC,IAAI,EAAER,OADQ;MAEdS,OAAO,EAAE;IAFK,CAPX;IAWLC,MAAM,EAAE;MACNF,IAAI,EAAE,CAACG,MAAD,EAASP,MAAT,CADA;MAENK,OAAO,EAAE;IAFH,CAXH;IAeLG,SAAS,EAAE;MACTJ,IAAI,EAAEJ,MADG;MAETK,OAAO,EAAE;IAFA;EAfN,CAXsB;EA+B7BI,IAAI,EAAE,SAASA,IAAT,GAAgB;IACpB,OAAO;MACL;MACAC,YAAY,EAAE,KAAKb;IAFd,CAAP;EAID,CApC4B;EAqC7Bc,OAAO,EAAE,SAASA,OAAT,GAAmB;IAC1B,KAAKD,YAAL,GAAoB,KAAKb,OAAzB;EACD,CAvC4B;EAwC7Be,OAAO,EAAE,SAASA,OAAT,GAAmB;IAC1B,IAAI,KAAKT,cAAT,EAAyB;MACvB,KAAKZ,KAAL;IACD;EACF,CA5C4B;EA6C7BsB,KAAK,EAAE;IACLhB,OAAO,EAAE,OADJ;IAELC,QAAQ,EAAE;EAFL,CA7CsB;EAiD7BgB,OAAO,EAAE;IACP;IACAvB,KAAK,EAAE,SAASA,KAAT,GAAiB;MACtB,IAAIwB,KAAK,GAAG,IAAZ;;MAEA,KAAKC,SAAL,CAAe,YAAY;QACzB,IAAID,KAAK,CAACL,YAAN,IAAsBK,KAAK,CAACjB,QAA5B,IAAwCiB,KAAK,CAACpB,KAAlD,EAAyD;UACvD;QACD;;QAED,IAAIsB,EAAE,GAAGF,KAAK,CAACzB,GAAf;QAAA,IACID,QAAQ,GAAG0B,KAAK,CAAC1B,QADrB;QAAA,IAEIiB,MAAM,GAAGS,KAAK,CAACT,MAFnB;QAAA,IAGIE,SAAS,GAAGO,KAAK,CAACP,SAHtB;QAIA,IAAIU,YAAJ;;QAEA,IAAI7B,QAAQ,CAAC8B,qBAAb,EAAoC;UAClCD,YAAY,GAAG7B,QAAQ,CAAC8B,qBAAT,EAAf;QACD,CAFD,MAEO;UACLD,YAAY,GAAG;YACbE,GAAG,EAAE,CADQ;YAEbC,MAAM,EAAEhC,QAAQ,CAACiC;UAFJ,CAAf;QAID;;QAED,IAAIC,cAAc,GAAGL,YAAY,CAACG,MAAb,GAAsBH,YAAY,CAACE,GAAxD;QACA;;QAEA,IAAI,CAACG,cAAD,IAAmB5C,QAAQ,CAACsC,EAAD,CAA/B,EAAqC;UACnC,OAAO,KAAP;QACD;;QAED,IAAIO,WAAW,GAAG,KAAlB;;QAEA,IAAIC,eAAe,GAAGV,KAAK,CAACW,KAAN,CAAYC,WAAZ,CAAwBR,qBAAxB,EAAtB;;QAEA,IAAIX,SAAS,KAAK,IAAlB,EAAwB;UACtBgB,WAAW,GAAGN,YAAY,CAACE,GAAb,GAAmBK,eAAe,CAACL,GAAnC,IAA0Cd,MAAxD;QACD,CAFD,MAEO;UACLkB,WAAW,GAAGC,eAAe,CAACJ,MAAhB,GAAyBH,YAAY,CAACG,MAAtC,IAAgDf,MAA9D;QACD;;QAED,IAAIkB,WAAJ,EAAiB;UACfT,KAAK,CAACL,YAAN,GAAqB,IAArB;;UAEAK,KAAK,CAACa,KAAN,CAAY,OAAZ,EAAqB,IAArB;;UAEAb,KAAK,CAACa,KAAN,CAAY,MAAZ;QACD;MACF,CA5CD;IA6CD,CAlDM;IAmDPC,cAAc,EAAE,SAASA,cAAT,GAA0B;MACxC,KAAKD,KAAL,CAAW,cAAX,EAA2B,KAA3B;MACA,KAAKrC,KAAL;IACD,CAtDM;IAuDPuC,UAAU,EAAE,SAASA,UAAT,GAAsB;MAChC,IAAIC,CAAC,GAAG,KAAKC,cAAb;;MAEA,IAAI,KAAKtB,YAAL,IAAqB,CAAC,KAAKZ,QAA/B,EAAyC;QACvC,OAAOiC,CAAC,CAAC,KAAD,EAAQ;UACd,OAAO,SADO;UAEd,SAAS9C,GAAG,CAAC,SAAD;QAFE,CAAR,EAGL,CAAC,KAAKgD,KAAL,CAAW,SAAX,KAAyBF,CAAC,CAACjD,OAAD,EAAU;UACtC,SAAS;YACP,QAAQ;UADD;QAD6B,CAAV,EAI3B,CAAC,KAAKmB,WAAL,IAAoBf,CAAC,CAAC,SAAD,CAAtB,CAJ2B,CAA3B,CAHK,CAAR;MAQD;IACF,CApEM;IAqEPgD,eAAe,EAAE,SAASA,eAAT,GAA2B;MAC1C,IAAIH,CAAC,GAAG,KAAKC,cAAb;;MAEA,IAAI,KAAKlC,QAAT,EAAmB;QACjB,IAAIqC,IAAI,GAAG,KAAKF,KAAL,CAAW,UAAX,KAA0B,KAAK/B,YAA1C;;QAEA,IAAIiC,IAAJ,EAAU;UACR,OAAOJ,CAAC,CAAC,KAAD,EAAQ;YACd,SAAS9C,GAAG,CAAC,eAAD;UADE,CAAR,EAEL,CAACkD,IAAD,CAFK,CAAR;QAGD;MACF;IACF,CAjFM;IAkFPC,YAAY,EAAE,SAASA,YAAT,GAAwB;MACpC,IAAIL,CAAC,GAAG,KAAKC,cAAb;;MAEA,IAAI,KAAKrC,KAAT,EAAgB;QACd,IAAIwC,IAAI,GAAG,KAAKF,KAAL,CAAW,OAAX,KAAuB,KAAKlC,SAAvC;;QAEA,IAAIoC,IAAJ,EAAU;UACR,OAAOJ,CAAC,CAAC,KAAD,EAAQ;YACd,MAAM;cACJ,SAAS,KAAKF;YADV,CADQ;YAId,SAAS5C,GAAG,CAAC,YAAD;UAJE,CAAR,EAKL,CAACkD,IAAD,CALK,CAAR;QAMD;MACF;IACF;EAjGM,CAjDoB;EAoJ7BE,MAAM,EAAE,SAASA,MAAT,GAAkB;IACxB,IAAIN,CAAC,GAAGO,SAAS,CAAC,CAAD,CAAjB;IACA,IAAIC,WAAW,GAAGR,CAAC,CAAC,KAAD,EAAQ;MACzB,OAAO,aADkB;MAEzB,OAAO,aAFkB;MAGzB,SAAS9C,GAAG,CAAC,aAAD;IAHa,CAAR,CAAnB;IAKA,OAAO8C,CAAC,CAAC,KAAD,EAAQ;MACd,SAAS9C,GAAG,EADE;MAEd,SAAS;QACP,QAAQ,MADD;QAEP,aAAa,KAAKyB;MAFX;IAFK,CAAR,EAML,CAAC,KAAKF,SAAL,KAAmB,MAAnB,GAA4B,KAAKyB,KAAL,EAA5B,GAA2CM,WAA5C,EAAyD,KAAKT,UAAL,EAAzD,EAA4E,KAAKI,eAAL,EAA5E,EAAoG,KAAKE,YAAL,EAApG,EAAyH,KAAK5B,SAAL,KAAmB,IAAnB,GAA0B,KAAKyB,KAAL,EAA1B,GAAyCM,WAAlK,CANK,CAAR;EAOD;AAlK4B,CAAD,CAA9B"},"metadata":{},"sourceType":"module"}