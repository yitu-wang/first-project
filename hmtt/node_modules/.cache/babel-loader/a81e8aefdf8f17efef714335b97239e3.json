{"ast":null,"code":"import { isHidden } from '../utils/dom/style';\nimport { unitToPx } from '../utils/format/unit';\nimport { createNamespace, isDef, isServer } from '../utils';\nimport { getScrollTop, getElementTop, getScroller } from '../utils/dom/scroll';\nimport { BindEventMixin } from '../mixins/bind-event';\n\nvar _createNamespace = createNamespace('sticky'),\n    createComponent = _createNamespace[0],\n    bem = _createNamespace[1];\n\nexport default createComponent({\n  mixins: [BindEventMixin(function (bind, isBind) {\n    if (!this.scroller) {\n      this.scroller = getScroller(this.$el);\n    }\n\n    if (this.observer) {\n      var method = isBind ? 'observe' : 'unobserve';\n      this.observer[method](this.$el);\n    }\n\n    bind(this.scroller, 'scroll', this.onScroll, true);\n    this.onScroll();\n  })],\n  props: {\n    zIndex: [Number, String],\n    container: null,\n    offsetTop: {\n      type: [Number, String],\n      default: 0\n    }\n  },\n  data: function data() {\n    return {\n      fixed: false,\n      height: 0,\n      transform: 0\n    };\n  },\n  computed: {\n    offsetTopPx: function offsetTopPx() {\n      return unitToPx(this.offsetTop);\n    },\n    style: function style() {\n      if (!this.fixed) {\n        return;\n      }\n\n      var style = {};\n\n      if (isDef(this.zIndex)) {\n        style.zIndex = this.zIndex;\n      }\n\n      if (this.offsetTopPx && this.fixed) {\n        style.top = this.offsetTopPx + \"px\";\n      }\n\n      if (this.transform) {\n        style.transform = \"translate3d(0, \" + this.transform + \"px, 0)\";\n      }\n\n      return style;\n    }\n  },\n  watch: {\n    fixed: function fixed(isFixed) {\n      this.$emit('change', isFixed);\n    }\n  },\n  created: function created() {\n    var _this = this; // compatibility: https://caniuse.com/#feat=intersectionobserver\n\n\n    if (!isServer && window.IntersectionObserver) {\n      this.observer = new IntersectionObserver(function (entries) {\n        // trigger scroll when visibility changed\n        if (entries[0].intersectionRatio > 0) {\n          _this.onScroll();\n        }\n      }, {\n        root: document.body\n      });\n    }\n  },\n  methods: {\n    onScroll: function onScroll() {\n      var _this2 = this;\n\n      if (isHidden(this.$el)) {\n        return;\n      }\n\n      this.height = this.$el.offsetHeight;\n      var container = this.container,\n          offsetTopPx = this.offsetTopPx;\n      var scrollTop = getScrollTop(window);\n      var topToPageTop = getElementTop(this.$el);\n\n      var emitScrollEvent = function emitScrollEvent() {\n        _this2.$emit('scroll', {\n          scrollTop: scrollTop,\n          isFixed: _this2.fixed\n        });\n      }; // The sticky component should be kept inside the container element\n\n\n      if (container) {\n        var bottomToPageTop = topToPageTop + container.offsetHeight;\n\n        if (scrollTop + offsetTopPx + this.height > bottomToPageTop) {\n          var distanceToBottom = this.height + scrollTop - bottomToPageTop;\n\n          if (distanceToBottom < this.height) {\n            this.fixed = true;\n            this.transform = -(distanceToBottom + offsetTopPx);\n          } else {\n            this.fixed = false;\n          }\n\n          emitScrollEvent();\n          return;\n        }\n      }\n\n      if (scrollTop + offsetTopPx > topToPageTop) {\n        this.fixed = true;\n        this.transform = 0;\n      } else {\n        this.fixed = false;\n      }\n\n      emitScrollEvent();\n    }\n  },\n  render: function render() {\n    var h = arguments[0];\n    var fixed = this.fixed;\n    var style = {\n      height: fixed ? this.height + \"px\" : null\n    };\n    return h(\"div\", {\n      \"style\": style\n    }, [h(\"div\", {\n      \"class\": bem({\n        fixed: fixed\n      }),\n      \"style\": this.style\n    }, [this.slots()])]);\n  }\n});","map":{"version":3,"names":["isHidden","unitToPx","createNamespace","isDef","isServer","getScrollTop","getElementTop","getScroller","BindEventMixin","_createNamespace","createComponent","bem","mixins","bind","isBind","scroller","$el","observer","method","onScroll","props","zIndex","Number","String","container","offsetTop","type","default","data","fixed","height","transform","computed","offsetTopPx","style","top","watch","isFixed","$emit","created","_this","window","IntersectionObserver","entries","intersectionRatio","root","document","body","methods","_this2","offsetHeight","scrollTop","topToPageTop","emitScrollEvent","bottomToPageTop","distanceToBottom","render","h","arguments","slots"],"sources":["C:/Users/小王/node_modules/vant/es/sticky/index.js"],"sourcesContent":["import { isHidden } from '../utils/dom/style';\nimport { unitToPx } from '../utils/format/unit';\nimport { createNamespace, isDef, isServer } from '../utils';\nimport { getScrollTop, getElementTop, getScroller } from '../utils/dom/scroll';\nimport { BindEventMixin } from '../mixins/bind-event';\n\nvar _createNamespace = createNamespace('sticky'),\n    createComponent = _createNamespace[0],\n    bem = _createNamespace[1];\n\nexport default createComponent({\n  mixins: [BindEventMixin(function (bind, isBind) {\n    if (!this.scroller) {\n      this.scroller = getScroller(this.$el);\n    }\n\n    if (this.observer) {\n      var method = isBind ? 'observe' : 'unobserve';\n      this.observer[method](this.$el);\n    }\n\n    bind(this.scroller, 'scroll', this.onScroll, true);\n    this.onScroll();\n  })],\n  props: {\n    zIndex: [Number, String],\n    container: null,\n    offsetTop: {\n      type: [Number, String],\n      default: 0\n    }\n  },\n  data: function data() {\n    return {\n      fixed: false,\n      height: 0,\n      transform: 0\n    };\n  },\n  computed: {\n    offsetTopPx: function offsetTopPx() {\n      return unitToPx(this.offsetTop);\n    },\n    style: function style() {\n      if (!this.fixed) {\n        return;\n      }\n\n      var style = {};\n\n      if (isDef(this.zIndex)) {\n        style.zIndex = this.zIndex;\n      }\n\n      if (this.offsetTopPx && this.fixed) {\n        style.top = this.offsetTopPx + \"px\";\n      }\n\n      if (this.transform) {\n        style.transform = \"translate3d(0, \" + this.transform + \"px, 0)\";\n      }\n\n      return style;\n    }\n  },\n  watch: {\n    fixed: function fixed(isFixed) {\n      this.$emit('change', isFixed);\n    }\n  },\n  created: function created() {\n    var _this = this;\n\n    // compatibility: https://caniuse.com/#feat=intersectionobserver\n    if (!isServer && window.IntersectionObserver) {\n      this.observer = new IntersectionObserver(function (entries) {\n        // trigger scroll when visibility changed\n        if (entries[0].intersectionRatio > 0) {\n          _this.onScroll();\n        }\n      }, {\n        root: document.body\n      });\n    }\n  },\n  methods: {\n    onScroll: function onScroll() {\n      var _this2 = this;\n\n      if (isHidden(this.$el)) {\n        return;\n      }\n\n      this.height = this.$el.offsetHeight;\n      var container = this.container,\n          offsetTopPx = this.offsetTopPx;\n      var scrollTop = getScrollTop(window);\n      var topToPageTop = getElementTop(this.$el);\n\n      var emitScrollEvent = function emitScrollEvent() {\n        _this2.$emit('scroll', {\n          scrollTop: scrollTop,\n          isFixed: _this2.fixed\n        });\n      }; // The sticky component should be kept inside the container element\n\n\n      if (container) {\n        var bottomToPageTop = topToPageTop + container.offsetHeight;\n\n        if (scrollTop + offsetTopPx + this.height > bottomToPageTop) {\n          var distanceToBottom = this.height + scrollTop - bottomToPageTop;\n\n          if (distanceToBottom < this.height) {\n            this.fixed = true;\n            this.transform = -(distanceToBottom + offsetTopPx);\n          } else {\n            this.fixed = false;\n          }\n\n          emitScrollEvent();\n          return;\n        }\n      }\n\n      if (scrollTop + offsetTopPx > topToPageTop) {\n        this.fixed = true;\n        this.transform = 0;\n      } else {\n        this.fixed = false;\n      }\n\n      emitScrollEvent();\n    }\n  },\n  render: function render() {\n    var h = arguments[0];\n    var fixed = this.fixed;\n    var style = {\n      height: fixed ? this.height + \"px\" : null\n    };\n    return h(\"div\", {\n      \"style\": style\n    }, [h(\"div\", {\n      \"class\": bem({\n        fixed: fixed\n      }),\n      \"style\": this.style\n    }, [this.slots()])]);\n  }\n});"],"mappings":"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"},"metadata":{},"sourceType":"module"}